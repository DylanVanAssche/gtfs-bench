<TriplesMapFare>
  # a rr:TriplesMap;

  rr:logicalTable [
    rr:sqlQuery """
        SELECT FARE_ATTRIBUTES.*, (CASE PAYMENT_METHOD
            WHEN 0 THEN 'OnBoard'
            WHEN 1 THEN 'BeforeBoarding'
        END) PAY, (CASE TRANSFERS
            WHEN 0 THEN 'NoTransfersAllowed'
            WHEN 1 THEN 'OneTransfersAllowed'
            WHEN 2 THEN 'TwoTransfersAllowed'
            ELSE 'UnlimitedTransfersAllowed'
        END) TRANS FROM FARE_ATTRIBUTES

        """ 
  ];

  rr:subjectMap [
    a rr:Subject;
    rr:template "http://linkedgtfs.com/CITY/fare/{FARE_ID}";
    rr:termType rr:IRI;
    rr:class gtfs:Fare;
  ];


  rr:predicateObjectMap[
    rr:predicate schema:price;
    rr:objectMap [
      rr:datatype xsd:string;
      rr:column "PRICE";
    ];
  ];

  rr:predicateObjectMap[
    rr:predicate schema:priceCurrency;
    rr:objectMap [
      rr:datatype xsd:string;
      rr:column "CURRENCY_TYPE";
    ];
  ];

  rr:predicateObjectMap[
    rr:predicate gtfs:paymentMethod;
    rr:objectMap [
      rr:template "http://vocab.gtfs.org/terms#{PAY}";
    ];
  ];

  rr:predicateObjectMap[
    rr:predicate gtfs:transfers;
    rr:objectMap [
      rr:template "http://vocab.gtfs.org/terms#{TRANS}";
    ];
  ];

  rr:predicateObjectMap[
    rr:predicate gtfs:transferExpiryTime;
    rr:objectMap [
      rr:datatype xsd:duration;
      rr:column "TRANSFER_DURATION";
    ];
  ];
.